<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Some blog</title>
    <link>http://odushyn.github.io/post/</link>
    <description>Recent content in Posts on Some blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 18 May 2016 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://odushyn.github.io/post/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>HTTP. How to return errors to clients?</title>
      <link>http://odushyn.github.io/post/http-return-errors-to-clients/</link>
      <pubDate>Wed, 18 May 2016 00:00:00 +0000</pubDate>
      
      <guid>http://odushyn.github.io/post/http-return-errors-to-clients/</guid>
      <description>

&lt;p&gt;HTTP is based on the exchange of representations.
Errors are not an exception.
Whenever error happens on a server either because of wrong request or server internal problems - &lt;em&gt;always&lt;/em&gt; return a representation that reflects the current state of the error.&lt;/p&gt;

&lt;p&gt;Response must contain:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Response code&lt;/li&gt;
&lt;li&gt;Body containing the error description.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&amp;ndash;&lt;/p&gt;

&lt;h4 id=&#34;response-code:8b601131e0377d009f81b11f358c85dc&#34;&gt;Response code&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;&lt;em&gt;helps clients to understand the reason why error happened&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Return &lt;em&gt;4xx&lt;/em&gt; status code for errors due to client inputs, &lt;em&gt;5xx&lt;/em&gt; - for errors due to server implementation.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;em&gt;keeps interacting correctly &amp;ldquo;visible&amp;rdquo; for middle-ware software&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Common mistake is to return success status code (200 - 206 and 300 - 307) for error describing.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;HTTP/1.1 200 OK
Content-Type: application/xml

&amp;lt;error&amp;gt;
    &amp;lt;message&amp;gt;There are no free seats left&amp;lt;/message&amp;gt;
&amp;lt;/error&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Doing this prevents HTTP-aware software from detecting errors.
For example, a cache will store it as a successful response and serve it to subsequent clients even when clients may be able to make a successful request.&lt;/p&gt;

&lt;p&gt;Client can rely on error status returned by a server. Client error handling may looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;    if(response.code &amp;gt;= 400 and response.code &amp;lt; 400) {
        // Failure due to client error
        ...
    }
    else if(response.code &amp;gt;= 500) {
        // Failure due to server error
        ...
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Error due to client inputs (the most often used ones):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;400 (Bad Request) - return this error when your server cannot decipher client requests because of syntactical errors.&lt;/li&gt;
&lt;li&gt;401 (Unauthorized) - return this when the client is not authorized to access the resource but may be able to gain access after authentication.&lt;/li&gt;
&lt;li&gt;403 (Forbidden) - use this when your server will not let the client gain access to the resource and
authentication will not help. For instance, you can return this when the user is already authenticated but is not
allowed to request a resource.&lt;/li&gt;
&lt;li&gt;404 (Not Found) - return this when the resource is not found. If possible, specify a reason in the
message body.&lt;/li&gt;
&lt;li&gt;405 (Not Allowed) - return this when an HTTP method is not allowed for this resource.
Return an Allow header with methods that are valid for this resource.&lt;/li&gt;
&lt;li&gt;409 (Conflict) - return this when the request conflicts with the current state of the resource. Include
a body explaining the reason.&lt;/li&gt;
&lt;li&gt;410 (Gone) - return this when the resource used to exist, but it does not anymore (if you don&amp;rsquo;t keep track of deleted files on a server then just return 404).&lt;/li&gt;
&lt;li&gt;413 (Request Entity Too Large) - return this when the body of a POST of PUT request is too large. If possible, specify what is allowed in the body, and provide alternatives.&lt;/li&gt;
&lt;li&gt;415 (Unsupported Media Type) - return this error when a client sends the message body in a format that the server
does not understand.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&amp;ndash;&lt;/p&gt;

&lt;p&gt;Error due to server (the most often used ones):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;500 (Internal Server Error) - this is the best code to return when your code on the server side failed due to some  implementation bug.&lt;/li&gt;
&lt;li&gt;503 (Service Unavailable) - return this when the server cannot fulfil the request either for some specific interval
or for an undetermined amount of time.
Two common conditions that prompt this error are failures with back-end servers
(such as a database connection failure) or when the client exceeded some rate limit
set by the server.
If possible, include a Retry-After response header with either a date or a number
of seconds as a hint.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&amp;ndash;&lt;/p&gt;

&lt;h4 id=&#34;response-body:8b601131e0377d009f81b11f358c85dc&#34;&gt;Response body&lt;/h4&gt;

&lt;p&gt;&lt;em&gt;describes the error in a plain text or human readable HTML&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The body must contain enough information to understand why the error occurred and how it can be fixed by the client.&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Provide a link to the documentation with error detailed description if the one exist.&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;If you are logging errors on a server side provide a link that can be used to refer to this error.&lt;/li&gt;
&lt;li&gt;Keep the response body descriptive, but exclude details such as stack traces, errors from
database connection failures, etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&amp;ndash;&lt;/p&gt;

&lt;p&gt;I prefer using the next template:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;{
    message: Impossible to order a seat
    description: There are no free seats left
    code: 1000
    link: http://myproject/documentation/seats/ordering
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;code&lt;/em&gt; is a identifier for an error message. It makes possible maintaining different translations for each error message on a client side for example.&lt;/p&gt;

&lt;h4 id=&#34;references:8b601131e0377d009f81b11f358c85dc&#34;&gt;References&lt;/h4&gt;

&lt;ol&gt;
&lt;li&gt;MOE (My Own Experience)&lt;/li&gt;
&lt;li&gt;RESTful Web Services Cookbook (O&amp;rsquo;Reilly Media) by Subbu Allamaraju&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
  </channel>
</rss>